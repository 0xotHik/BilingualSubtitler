[![Как работает Bilingual Subtitler (Просмотр на английском с подключаемым русскими субтитрами)](https://0xothik.files.wordpress.com/2022/08/busib-yt-srgb-withplaybutton.png)](https://www.youtube.com/watch?v=7TSPPbmpXsw "Как работает Bilingual Subtitler (Просмотр на английском с подключаемым русскими субтитрами)")
<br>
<br>
<a href="https://yasobe.ru/na/0xothik" target="_blank" rel="noopener"><img class="alignnone size-full wp-image-5000" src="https://0xothik.files.wordpress.com/2020/06/ya-thx-20.png" alt="Спасибо, которое намажешь на хлеб" width="134" height="20" /></a>
<a href="https://0xothik.wordpress.com/bilingual-subtitler/"><p style="text-align: center;"><strong><span style="color: #999999;">Bilingual</span> <span style="color: #ffd700;">Subtitler</span></strong></p></a>
Бесплатная программа, позволяющая сочетать 2 клевых занятия: просмотр кино/сериалов и изучение иностранного языка – одновременно: при помощи динамически подключаемых к оригинальным переведенных субтитров.

*Любого кино/сериала.<br>
Любого иностранного языка — при помощи субтитров на любом, родном вам<br>
Возможны постоянно подключенные к оригинальным переведенные субтитры*<br>

<hr>

<a href="https://0xothik.wordpress.com/bilingual-subtitler/"><b>Страница программы, с полным описанием→</b></a>
<hr><br/>
<a href="https://github.com/0xotHik/BilingualSubtitler/releases/latest"><b>Скачать последний релиз →</b></a>
<hr><br/>
<a href="https://www.youtube.com/watch?v=7TSPPbmpXsw"><b>Видеогайд по программе и просмотру с подключаемыми русскими субтитрами →</b></a>
<hr><br/>

**Как работает программа:** <br/>
1. Создание двуязычных субтитров: <br/>
- После загрузки пользователем оригинальных и нужного количества русских субтитров и выбора цветов, по кнопке "Создать субтитры" по пути в окне "Путь итоговых файлов" создаются 2 файла с **.ass**-субтитрами — оригинальными и двуязычными (или только двуязычные, если пользователь выбрал такую опцию в настройках). <br/>
2. Воспроизведение с динамически включаемыми двуязычными субтитрами субтитрами.<br/>
Пользователь стартует воспроизведение видео в видеоплеере с английскими субтитрами. Предполагается, что видеоплеер поставит первыми в списке дорожек субтитров именно созданные файлы с оригинальными и двуязычными субтитрами (так делает Media Player Classic HomeCinema) Когда в субтитрах появляется непонятный ему момент, пользователь нажимает горячую клавишу, заданную в программе [события нажатия клавиш "слушает" **NeatInput**]. В этот момент в программе проверяется совпадение имени активного процесса [получаем через функцию **GetForegroundWindow** и **GetWindowThreadProcessId** из **user32.dll**] имени процесса видеоплеера, задаваемому в настройках, и в случае совпадения — эмулируются нажатия на клавишу паузы и смены субтитров на следующие. [Эмуляция происходит либо через функцию **PostMessage** из **user32.dll** (в случае, если эмулируется нажатие одной клавиши), либо через библиотеку **WindowsInput.[InputSimulator](https://github.com/michaelnoonan/inputsimulator)** (в случае эмуляции нажатия сочетания клавиши и клавиши-модификатора Ctrl, Alt или Shift. Через InputSimulator на глаз работает помедленнее, чем через PostMessage (потому что, как я понимаю, InputSimulator полноценно эмулирует нажатие клавиш, PostMessage лишь посылает сигнал о нажатии в процесс), но я не смог через PostMessage воплотить нажатие сочетания клавиши и клавиши-модификатора).] Пользователь прочитывает варианты перевода, вновь нажимает на горячую клавишу программы — эмулируются нажатия на клавишу паузы и смены субтитров на предыдущие — вновь включаются одни английские субтитры, воспроизведение продолжается.

<span style="text-decoration: underline;">**Авторы:**</span> 
- Автор программы — Евгений <span style="color: #000080;">**0xotHik**</span> Помелов<br/><br/>
Программа использует:
*   [Библиотеки Яндекс.Лингвистики для .Net](https://habrahabr.ru/post/204372/) авторства Ивана **KvanTTT** Кочуркина ([StackOverflow](http://stackoverflow.com/users/1046374/kvanttt), [LinkedIn](https://ru.linkedin.com/in/kvanttt/en), [GitHub](http://github.com/KvanTTT/))
*   [Библиотеку **LibSE**](https://github.com/SubtitleEdit/subtitleedit/tree/master/libse) из состава приложения [Subtitle Edit](https://0xothik.wordpress.com/bilingual-subtitler#SubtitleEdit) — с её помощью осуществляется считывание субтитров из файлов .mkv.
*   [Библиотеку **Windows Input Simulator**](https://github.com/michaelnoonan/inputsimulator) (с неправильными примерами кода в разделе Example :))
*   [Библиотеку **NeatInput**](https://github.com/LegendaryB/NeatInput)
*   [Библиотеку **DocX**](https://github.com/xceedsoftware/DocX)
*   [Библиотеку **KnownFolders**](https://gitlab.com/Syroot/KnownFolders)
*   [Библиотеку **OctoKit**](https://github.com/octokit/octokit.net)
*   Установщик создан через [программу **Inno Setup**](https://jrsoftware.org/isinfo.php)

- Большое спасибо компании **Яндекс** за предоставление бесплатного доступа Яндекс.Переводчику.
<br>

Автор будет рад [откликам о программе в любом виде](https://0xothik.wordpress.com/bilingual-subtitler#ContactMe)

**Замечание:** Возможно некоторое несоответствие между бинарниками в "Релизах" и исходным кодом к ним, формируемым GitHub'ом — периодически я коммитил изменения, которые вошли в  бинарники, уже после оформления Релиза.<br>
**P.S.:** Программа писалась после работы в свободное время забесплатно, чем могут быть объяснены некоторые шероховатости исходного кода, если таковые обнаружатся имеющими место быть.
